/*! For license information please see code.js.LICENSE.txt */
(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){s=!0,i=e},f:function(){try{c||null==n.return||n.return()}finally{if(s)throw i}}}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function n(){"use strict";n=function(){return r};var t,r={},a=Object.prototype,o=a.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},c="function"==typeof Symbol?Symbol:{},s=c.iterator||"@@iterator",u=c.asyncIterator||"@@asyncIterator",l=c.toStringTag||"@@toStringTag";function f(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch(t){f=function(e,t,r){return e[t]=r}}function p(e,t,r,n){var a=t&&t.prototype instanceof b?t:b,o=Object.create(a.prototype),c=new O(n||[]);return i(o,"_invoke",{value:P(e,r,c)}),o}function g(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}r.wrap=p;var d="suspendedStart",h="suspendedYield",m="executing",y="completed",v={};function b(){}function x(){}function w(){}var k={};f(k,s,(function(){return this}));var I=Object.getPrototypeOf,S=I&&I(I(M([])));S&&S!==a&&o.call(S,s)&&(k=S);var E=w.prototype=b.prototype=Object.create(k);function N(e){["next","throw","return"].forEach((function(t){f(e,t,(function(e){return this._invoke(t,e)}))}))}function L(t,r){function n(a,i,c,s){var u=g(t[a],t,i);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==e(f)&&o.call(f,"__await")?r.resolve(f.__await).then((function(e){n("next",e,c,s)}),(function(e){n("throw",e,c,s)})):r.resolve(f).then((function(e){l.value=e,c(l)}),(function(e){return n("throw",e,c,s)}))}s(u.arg)}var a;i(this,"_invoke",{value:function(e,t){function o(){return new r((function(r,a){n(e,t,r,a)}))}return a=a?a.then(o,o):o()}})}function P(e,r,n){var a=d;return function(o,i){if(a===m)throw Error("Generator is already running");if(a===y){if("throw"===o)throw i;return{value:t,done:!0}}for(n.method=o,n.arg=i;;){var c=n.delegate;if(c){var s=A(c,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===d)throw a=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=m;var u=g(e,r,n);if("normal"===u.type){if(a=n.done?y:h,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(a=y,n.method="throw",n.arg=u.arg)}}}function A(e,r){var n=r.method,a=e.iterator[n];if(a===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var o=g(a,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,v;var i=o.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function z(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(z,this),this.reset(!0)}function M(r){if(r||""===r){var n=r[s];if(n)return n.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var a=-1,i=function e(){for(;++a<r.length;)if(o.call(r,a))return e.value=r[a],e.done=!1,e;return e.value=t,e.done=!0,e};return i.next=i}}throw new TypeError(e(r)+" is not iterable")}return x.prototype=w,i(E,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:x,configurable:!0}),x.displayName=f(w,l,"GeneratorFunction"),r.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===x||"GeneratorFunction"===(t.displayName||t.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,f(e,l,"GeneratorFunction")),e.prototype=Object.create(E),e},r.awrap=function(e){return{__await:e}},N(L.prototype),f(L.prototype,u,(function(){return this})),r.AsyncIterator=L,r.async=function(e,t,n,a,o){void 0===o&&(o=Promise);var i=new L(p(e,t,n,a),o);return r.isGeneratorFunction(t)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},N(E),f(E,l,"Generator"),f(E,s,(function(){return this})),f(E,"toString",(function(){return"[object Generator]"})),r.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},r.values=M,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,a){return c.type="throw",c.arg=e,r.next=n,a&&(r.method="next",r.arg=t),!!a}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=o.call(i,"catchLoc"),u=o.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;C(r)}return a}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:M(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),v}},r}function a(e,t,r,n,a,o,i){try{var c=e[o](i),s=c.value}catch(e){return void r(e)}c.done?t(s):Promise.resolve(s).then(n,a)}function o(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function c(e){a(i,n,o,c,s,"next",e)}function s(e){a(i,n,o,c,s,"throw",e)}c(void 0)}))}}var i=!1,c=null,s={aiModel:"claude-3-sonnet",designStyle:"modern"},u={colors:{primary:{r:.1,g:.1,b:.9,a:1},secondary:{r:.2,g:.2,b:.7,a:1},accent:{r:.9,g:.2,b:.2,a:1},text:{r:.1,g:.1,b:.1,a:1},background:{r:1,g:1,b:1,a:1},gray:{r:.9,g:.9,b:.9,a:1}},text:{heading:{fontName:{family:"Inter",style:"Bold"},fontSize:32},subheading:{fontName:{family:"Inter",style:"SemiBold"},fontSize:24},body:{fontName:{family:"Inter",style:"Regular"},fontSize:16},caption:{fontName:{family:"Inter",style:"Regular"},fontSize:12}},spacing:{small:8,medium:16,large:24,xlarge:40}};function l(e){if(console.log("Server message:",e),e&&e.type)switch(e.type){case"CONNECTION_ESTABLISHED":c=e.connectionId,figma.notify("MCP 서버에 연결되었습니다 (ID: ".concat(c,")"));break;case"EXECUTE_COMMAND":!function(e,t,r){y.apply(this,arguments)}(e.command,e.params,e.commandId);break;case"commandResult":!function(e){if(e.command)if("PROCESS_PROMPT"===e.command){if(e.error)return void figma.ui.postMessage({type:"prompt-processing-failed",error:e.error});figma.ui.postMessage({type:"prompt-processing-success"}),function(e){d.apply(this,arguments)}(e.result)}else console.log("Unhandled command result: ".concat(e.command))}(e);break;default:console.log("Unhandled message type: ".concat(e.type))}else console.warn("Invalid message format")}function f(e,t){var r={type:"COMMAND_RESPONSE",commandId:e,result:t,error:arguments.length>2&&void 0!==arguments[2]?arguments[2]:null};figma.ui.postMessage({type:"send-message",data:r})}function p(e,t){return g.apply(this,arguments)}function g(){return(g=o(n().mark((function e(t,r){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,i){e.next=3;break}throw new Error("MCP 서버에 연결되어 있지 않습니다");case 3:figma.ui.postMessage({type:"prompt-processing-started"}),figma.notify("AI 요청 처리 중..."),figma.ui.postMessage({type:"send-message",data:{type:"PROCESS_PROMPT",prompt:t,designerName:r,settings:s}}),e.next=13;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("프롬프트 처리 오류:",e.t0),figma.notify("오류: ".concat(e.t0.message)),figma.ui.postMessage({type:"prompt-processing-failed",error:e.t0.message});case 13:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function d(){return(d=o(n().mark((function e(r){var a,o,i,c,s,l,f,p,g,d,m,y,x,w,k,I;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,figma.ui.postMessage({type:"generation-started"}),figma.notify("AI 응답을 기반으로 포트폴리오 생성 중..."),console.log("AI Response:",r),(a=figma.createPage()).name=r.portfolioName||"AI 생성 포트폴리오",figma.currentPage=a,o=r.canvasSize&&r.canvasSize.width?r.canvasSize.width:1920,i=r.canvasSize&&r.canvasSize.height?r.canvasSize.height:1080,c=u.colors.background,r.style&&r.style.colors&&r.style.colors.background&&(c=v(r.style.colors.background)),e.next=13,b({name:r.portfolioName||"AI 생성 포트폴리오",width:o,height:i,backgroundColor:c});case 13:if(s=e.sent,l=u.spacing.xlarge,r.style&&r.style.spacing&&r.style.spacing.pagePadding&&(l=r.style.spacing.pagePadding),f=1600,r.layout&&r.layout.contentWidth&&(f=r.layout.contentWidth),p=l,g=(o-f)/2,!r.sections||!Array.isArray(r.sections)){e.next=48;break}d=t(r.sections),e.prev=22,d.s();case 24:if((m=d.n()).done){e.next=40;break}return y=m.value,x=null,y.backgroundColor&&(x=v(y.backgroundColor)),e.next=30,L({frameId:s.id,title:y.title||"섹션",x:g,y:p,width:f,backgroundColor:x});case 30:if(w=e.sent,!y.content){e.next=34;break}return e.next=34,h(y,w,f);case 34:k=u.spacing.xlarge,r.style&&r.style.spacing&&r.style.spacing.sectionGap&&(k=r.style.spacing.sectionGap),(p+=w.height+k)>s.height&&(I=figma.currentPage.findOne((function(e){return e.id===s.id})))&&I.resize(s.width,p+l);case 38:e.next=24;break;case 40:e.next=45;break;case 42:e.prev=42,e.t0=e.catch(22),d.e(e.t0);case 45:return e.prev=45,d.f(),e.finish(45);case 48:figma.notify("AI 기반 포트폴리오가 생성되었습니다!"),figma.ui.postMessage({type:"generation-success"}),e.next=57;break;case 52:e.prev=52,e.t1=e.catch(0),console.error("AI 응답 기반 포트폴리오 생성 오류:",e.t1),figma.notify("오류: ".concat(e.t1.message)),figma.ui.postMessage({type:"generation-failed",error:e.t1.message});case 57:case"end":return e.stop()}}),e,null,[[0,52],[22,42,45,48]])})))).apply(this,arguments)}function h(e,t,r){return m.apply(this,arguments)}function m(){return(m=o(n().mark((function e(r,a,o){var i,c,s,l,f,p,g,d,h,m,y,b,x,k;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=a.contentY,c=u.spacing.medium,s=o-2*u.spacing.medium,r.content&&Array.isArray(r.content)){e.next=5;break}return e.abrupt("return");case 5:l=t(r.content),e.prev=6,l.s();case 8:if((f=l.n()).done){e.next=40;break}p=f.value,figma.getNodeById(a.id),e.t0=p.type,e.next="text"===e.t0?14:"image"===e.t0?22:"rectangle"===e.t0?30:38;break;case 14:return g=u.colors.text,p.color&&(g=v(p.color)),e.next=18,w({frameId:a.id,text:p.text||"",x:c,y:i,width:s,styleType:p.style||"body",color:g,horizontalAlignment:p.alignment||"LEFT"});case 18:return d=e.sent,(h=figma.getNodeById(d.id))&&(i+=h.height+u.spacing.medium),e.abrupt("break",38);case 22:return m=u.colors.gray,p.color&&(m=v(p.color)),y=p.height||300,e.next=27,E({frameId:a.id,name:p.name||"Image",x:c,y:i,width:p.width||s,height:y,color:m});case 27:return e.sent,i+=y+u.spacing.medium,e.abrupt("break",38);case 30:return b=u.colors.gray,p.color&&(b=v(p.color)),x=p.height||100,e.next=35,I({frameId:a.id,x:c,y:i,width:p.width||s,height:x,color:b,cornerRadius:p.cornerRadius||0});case 35:return e.sent,i+=x+u.spacing.medium,e.abrupt("break",38);case 38:e.next=8;break;case 40:e.next=45;break;case 42:e.prev=42,e.t1=e.catch(6),l.e(e.t1);case 45:return e.prev=45,l.f(),e.finish(45);case 48:(k=figma.getNodeById(a.id))&&k.resize(k.width,i+u.spacing.medium);case 50:case"end":return e.stop()}}),e,null,[[6,42,45,48]])})))).apply(this,arguments)}function y(){return(y=o(n().mark((function e(t,r,a){var o;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,o=null,e.t0=t,e.next="createFrame"===e.t0?5:"createText"===e.t0?9:"createRectangle"===e.t0?13:"createImagePlaceholder"===e.t0?17:"createSection"===e.t0?21:"applyTemplate"===e.t0?25:"getPluginInfo"===e.t0?29:31;break;case 5:return e.next=7,b(r);case 7:return o=e.sent,e.abrupt("break",32);case 9:return e.next=11,w(r);case 11:return o=e.sent,e.abrupt("break",32);case 13:return e.next=15,I(r);case 15:return o=e.sent,e.abrupt("break",32);case 17:return e.next=19,E(r);case 19:return o=e.sent,e.abrupt("break",32);case 21:return e.next=23,L(r);case 23:return o=e.sent,e.abrupt("break",32);case 25:return e.next=27,A(r);case 27:return o=e.sent,e.abrupt("break",32);case 29:return o={version:"1.0.0",connected:i,connectionId:c},e.abrupt("break",32);case 31:throw new Error("Unknown command: ".concat(t));case 32:f(a,o),e.next=39;break;case 35:e.prev=35,e.t1=e.catch(0),console.error("Command execution error (".concat(t,"):"),e.t1),f(a,null,e.t1.message);case 39:case"end":return e.stop()}}),e,null,[[0,35]])})))).apply(this,arguments)}function v(e){if(!e)return null;if("r"in e&&"g"in e&&"b"in e)return{r:e.r,g:e.g,b:e.b,a:e.a||1};if("red"in e&&"green"in e&&"blue"in e)return{r:e.red/255,g:e.green/255,b:e.blue/255,a:e.alpha||1};if("string"==typeof e&&e.startsWith("#")){var t=e.substring(1);return{r:parseInt(t.substr(0,2),16)/255,g:parseInt(t.substr(2,2),16)/255,b:parseInt(t.substr(4,2),16)/255,a:1}}return u.colors.text}function b(e){return x.apply(this,arguments)}function x(){return(x=o(n().mark((function e(t){var r,a,o,i,c,s,l,f,p,g,d,h,m;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.name,a=void 0===r?"New Frame":r,o=t.width,i=void 0===o?800:o,c=t.height,s=void 0===c?600:c,l=t.x,f=void 0===l?0:l,p=t.y,g=void 0===p?0:p,d=t.backgroundColor,h=void 0===d?u.colors.background:d,(m=figma.createFrame()).name=a,m.resize(i,s),m.x=f,m.y=g,m.fills=[{type:"SOLID",color:h}],figma.currentPage.appendChild(m),e.abrupt("return",{id:m.id,name:m.name,width:i,height:s});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e){return k.apply(this,arguments)}function k(){return(k=o(n().mark((function e(t){var r,a,o,i,c,s,l,f,p,g,d,h,m,y,v,b,x,w;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.text,a=void 0===r?"":r,o=t.frameId,i=t.x,c=void 0===i?0:i,s=t.y,l=void 0===s?0:s,f=t.width,p=void 0===f?300:f,g=t.styleType,d=void 0===g?"body":g,h=t.color,m=void 0===h?u.colors.text:h,y=t.horizontalAlignment,v=void 0===y?"LEFT":y,b=u.text[d]||u.text.body,(x=figma.createText()).x=c,x.y=l,x.resize(p,x.height),x.textAlignHorizontal=v,e.next=9,figma.loadFontAsync(b.fontName);case 9:return x.fontName=b.fontName,x.fontSize=b.fontSize,x.characters=a,x.fills=[{type:"SOLID",color:m}],o&&(w=figma.getNodeById(o))&&"FRAME"===w.type?w.appendChild(x):figma.currentPage.appendChild(x),e.abrupt("return",{id:x.id,text:x.characters,height:x.height});case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(e){return S.apply(this,arguments)}function S(){return(S=o(n().mark((function e(t){var r,a,o,i,c,s,l,f,p,g,d,h,m,y,v;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.frameId,a=t.x,o=void 0===a?0:a,i=t.y,c=void 0===i?0:i,s=t.width,l=void 0===s?100:s,f=t.height,p=void 0===f?100:f,g=t.color,d=void 0===g?u.colors.gray:g,h=t.cornerRadius,m=void 0===h?0:h,(y=figma.createRectangle()).x=o,y.y=c,y.resize(l,p),y.fills=[{type:"SOLID",color:d}],m>0&&(y.cornerRadius=m),r&&(v=figma.getNodeById(r))&&"FRAME"===v.type?v.appendChild(y):figma.currentPage.appendChild(y),e.abrupt("return",{id:y.id,height:p});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e){return N.apply(this,arguments)}function N(){return(N=o(n().mark((function e(t){var r,a,o,i,c,s,l,f,p,g,d,h,m,y,v,b,x;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.frameId,a=t.name,o=void 0===a?"Image Placeholder":a,i=t.x,c=void 0===i?0:i,s=t.y,l=void 0===s?0:s,f=t.width,p=void 0===f?300:f,g=t.height,d=void 0===g?200:g,h=t.color,m=void 0===h?{r:.8,g:.8,b:.8,a:1}:h,(y=figma.createFrame()).name=o,y.x=c,y.y=l,y.resize(p,d),y.fills=[{type:"SOLID",color:m}],(v=figma.createRectangle()).resize(.3*p,.3*d),v.x=.35*p,v.y=.25*d,v.fills=[{type:"SOLID",color:{r:.6,g:.6,b:.6,a:1}}],y.appendChild(v),b=figma.createText(),e.next=16,figma.loadFontAsync(u.text.caption.fontName);case 16:return b.fontName=u.text.caption.fontName,b.fontSize=u.text.caption.fontSize,b.characters="Add Image",b.textAlignHorizontal="CENTER",b.x=.5*p-b.width/2,b.y=.6*d,b.fills=[{type:"SOLID",color:{r:.4,g:.4,b:.4,a:1}}],y.appendChild(b),r&&(x=figma.getNodeById(r))&&"FRAME"===x.type?x.appendChild(y):figma.currentPage.appendChild(y),e.abrupt("return",{id:y.id,name:y.name,height:d});case 26:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(e){return P.apply(this,arguments)}function P(){return(P=o(n().mark((function e(t){var r,a,o,i,c,s,l,f,p,g,d,h,m,y,v,b,x;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.frameId,a=t.title,o=void 0===a?"Section Title":a,i=t.x,c=void 0===i?0:i,s=t.y,l=void 0===s?0:s,f=t.width,p=void 0===f?800:f,g=t.backgroundColor,d=void 0===g?null:g,!r){e.next=7;break}if((h=figma.getNodeById(r))&&"FRAME"===h.type){e.next=5;break}throw new Error("유효하지 않은 프레임 ID");case 5:e.next=8;break;case 7:h=figma.currentPage;case 8:return(m=figma.createFrame()).name=o,m.x=c,m.y=l,m.resize(p,200),m.fills=d?[{type:"SOLID",color:d}]:[],e.next=16,w({text:o,x:u.spacing.medium,y:u.spacing.medium,width:p-2*u.spacing.medium,styleType:"subheading"});case 16:return y=e.sent,v=figma.getNodeById(y.id),m.appendChild(v),b=figma.createLine(),e.next=22,figma.loadFontAsync(u.text.body.fontName);case 22:return x=v.height+2*u.spacing.medium,b.x=0,b.y=x,b.resize(p,0),b.strokes=[{type:"SOLID",color:{r:.9,g:.9,b:.9,a:1}}],m.appendChild(b),m.resize(p,x+u.spacing.large),h.appendChild(m),e.abrupt("return",{id:m.id,name:m.name,height:m.height,contentY:x+u.spacing.medium});case 31:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e){return z.apply(this,arguments)}function z(){return(z=o(n().mark((function e(t){var r,a,o,i,c;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.template,a=t.data,o=1920,i=1080,r.canvasSize&&(r.canvasSize.width&&(o=r.canvasSize.width),r.canvasSize.height&&(i=r.canvasSize.height)),e.next=6,b({name:a&&a.name||"포트폴리오",width:o,height:i,backgroundColor:u.colors.background});case 6:return c=e.sent,e.abrupt("return",c);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e,t,r){return O.apply(this,arguments)}function O(){return(O=o(n().mark((function e(t,r,a){var o,i,c;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,figma.ui.postMessage({type:"generation-started"}),t){e.next=4;break}throw new Error("템플릿이 지정되지 않았습니다");case 4:return(o=figma.createPage()).name=r||"포트폴리오",figma.currentPage=o,i={name:a||"디자이너",title:"포트폴리오",sections:["intro","projects","skills","contact"]},e.next=10,A({template:{id:t},data:i});case 10:return c=e.sent,figma.notify("포트폴리오가 생성되었습니다!"),figma.ui.postMessage({type:"generation-success"}),e.abrupt("return",c);case 16:e.prev=16,e.t0=e.catch(0),console.error("포트폴리오 생성 중 오류:",e.t0),figma.notify("오류: ".concat(e.t0.message)),figma.ui.postMessage({type:"generation-failed",error:e.t0.message});case 21:case"end":return e.stop()}}),e,null,[[0,16]])})))).apply(this,arguments)}figma.showUI(__html__,{width:450,height:600}),figma.ui.onmessage=function(){var e=o(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("Message from UI:",t),e.t0=t.type,e.next="connected"===e.t0?4:"disconnected"===e.t0?7:"error"===e.t0?11:"ws-message"===e.t0?14:"generate-portfolio"===e.t0?16:"process-prompt"===e.t0?19:"save-settings"===e.t0?22:"notify"===e.t0?25:"close-plugin"===e.t0?27:29;break;case 4:return i=!0,figma.notify("MCP 서버에 연결되었습니다"),e.abrupt("break",29);case 7:return i=!1,c=null,figma.notify("MCP 서버와 연결이 종료되었습니다"),e.abrupt("break",29);case 11:return i=!1,figma.notify("오류: ".concat(t.message)),e.abrupt("break",29);case 14:return l(t.data),e.abrupt("break",29);case 16:return e.next=18,C(t.templateId,t.portfolioName,t.designerName);case 18:case 21:return e.abrupt("break",29);case 19:return e.next=21,p(t.prompt,t.designerName);case 22:return s=t.settings,figma.notify("설정이 저장되었습니다"),e.abrupt("break",29);case 25:return figma.notify(t.message),e.abrupt("break",29);case 27:return figma.closePlugin(t.message),e.abrupt("break",29);case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),figma.on("run",(function(e){switch(e.command){case"generate-portfolio":figma.ui.postMessage({type:"show-generator"});break;case"connect-mcp":figma.ui.postMessage({type:"connect",serverUrl:"ws://localhost:9000"});break;case"show-settings":figma.ui.postMessage({type:"show-settings"})}}))})();